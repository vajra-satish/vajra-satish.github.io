---
title: "Analyzining the Impact of Receiving Any Monetary Incentive on Decision to Learn the Result of HIV Test"
author: "Satish Bajracharya"
date: "2024-03-17"
categories: [RCT, R, Stata]
image: "image.jpg"
engine: "knitr"
---

We use data from **"The Demand for, and Impact of, Learning HIV Status"** study in Malawi. The study uses a randomized controlled trial (RCT), where individuals were provided varying degrees of monetary incentives to learn about their HIV status after receiving an HIV Test. 

::: callout-note
Study: Thornton, Rebecca L. 2008. “The Demand for, and Impact of, Learning HIV Status.” American Economic Review, 98 (5): 1829-63. 

Data file: [Click here](https://www.aeaweb.org/aer/data/dec08/20060732_data.zip)

Detailed description of the intervention: [Click here](https://www.povertyactionlab.org/evaluation/demand-and-impact-learning-hiv-status-malawi)
:::

We use the "Thorton HIV Testing Data.dta" for the analysis.

## Importing and describing the data

##### Execution in R

The data file is a Stata (.dta) file. To import the data set in R, we will need to install the **Haven** package in R and use the **read_dta()** function. Run the following code in R to install the Haven package:

```
install.packages("haven")
```

Now, import the data set and check the list of variables and number of observations. When you download the data file, it comes with a readme file. Please read the readme file to learn more about the variables. 

::: callout-tip
## The str function in R

The str () function in R provides the structure of the dataset. However, we will only use the names () and dim() function here to make the content of this analysis shorter. Please check the Stata execution section to get a detailed description of the variables. 
:::

```{r, warning=FALSE}
library(haven)
# import the .dta file
data <- read_dta("C:/Impact Evaluation/Regression Analysis/Data/Thornton HIV Testing Data.dta")
# List of variables
names(data)
# dimensions of the dataset
dim(data)
```

There are 44 variables and 4,820 observations.

##### Execution in Stata

Use the cd command to import the dataset. The describe command provides a list of variables with their types and labels. 

```{stata, engine.path="C:/Stata15/Stata-64.exe"}
cd "C://Impact Evaluation"
use "Regression Analysis\Data\Thornton HIV Testing Data.dta", clear 
describe
```

## Regression Analysis

Here, we analyze the impact of receiving any monetary incentive on the decision to receive results from study participant's HIV test. The **tinc** variable records the amount of monetary incentive received (in kwacha) by the study participants. We tabulate the variable tinc to see the range of monetary incentives offered.

##### Execution in R

```{r message = FALSE}
library(dplyr)
# ensure that all rows are diplayed when priting tibbles
options (tibble.print_max = Inf) 
# tabulate tinc
data |> filter(!is.na(tinc))|>
  select(tinc) |>
  group_by(tinc) |>
  summarize(count=n()) |>
  mutate(percent = count/sum(count)*100) |>
  round(digits = 2)
```
